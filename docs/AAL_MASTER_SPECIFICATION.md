# AAL Platform - Master Specification Document
# AAL 플랫폼 마스터 기획서

> **Version**: 1.0.0  
> **Last Updated**: 2026-01-19  
> **Status**: Production  

---

## 목차

1. [서비스 개요](#1-서비스-개요)
2. [시스템 아키텍처](#2-시스템-아키텍처)
3. [사용자 모델 및 권한 체계](#3-사용자-모델-및-권한-체계)
4. [기능 모듈 개요](#4-기능-모듈-개요)
5. [기술 스택](#5-기술-스택)
6. [관련 문서](#6-관련-문서)

---

## 1. 서비스 개요

### 1.1 서비스 비전

**AAL (Asia Logistics Link)**는 화주(Shipper)와 포워더(Forwarder)를 연결하는 B2B 물류 플랫폼입니다.

### 1.2 핵심 가치 제안

| 대상 | 가치 제안 |
|------|-----------|
| **화주 (Shipper)** | 복수 포워더로부터 경쟁 입찰을 받아 최적의 운임 및 서비스 선택 |
| **포워더 (Forwarder)** | 새로운 화주 확보 기회, 입찰 기반 영업 채널 |

### 1.3 서비스 범위

```
┌─────────────────────────────────────────────────────────────────┐
│                        AAL Platform                              │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │   견적 요청   │  │  비딩 시스템  │  │   계약/운송   │          │
│  │  (Quote)     │→│  (Bidding)   │→│  (Contract)  │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
│                                                                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ Market Data  │  │ News Intel   │  │ AI Assistant │          │
│  │  (지수/환율)  │  │  (뉴스/경고)  │  │  (대화형)    │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└─────────────────────────────────────────────────────────────────┘
```

### 1.4 운송 모드 지원

| 운송 유형 | Load Type | 지원 상태 |
|-----------|-----------|-----------|
| **Ocean (해상)** | FCL, LCL | ✅ 지원 |
| **Air (항공)** | Air Cargo | ✅ 지원 |
| **Truck (내륙)** | FTL, LTL | ✅ 지원 |

---

## 2. 시스템 아키텍처

### 2.1 전체 시스템 구성도

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              CLIENT LAYER                                │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      Frontend (Static HTML/JS)                   │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │   │
│  │  │quotation │ │ bidding  │ │  market  │ │   news   │           │   │
│  │  │  .html   │ │ -list    │ │  -data   │ │ -intel   │           │   │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │   │
│  └─────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼ HTTP/REST
┌─────────────────────────────────────────────────────────────────────────┐
│                              SERVER LAYER                                │
│  ┌──────────────────────────┐  ┌──────────────────────────┐            │
│  │   Flask Server (:5000)   │  │  FastAPI Server (:8001)  │            │
│  │  ─────────────────────   │  │  ─────────────────────   │            │
│  │  • Static File Serving   │  │  • Quote/Bidding API     │            │
│  │  • BOK/Market Data API   │  │  • Forwarder/Bid API     │            │
│  │  • News Intelligence API │  │  • Contract/Shipment API │            │
│  │  • AI Chat API (Gemini)  │  │  • Analytics API         │            │
│  │  • Auth API              │  │  • Commerce API          │            │
│  └──────────────────────────┘  └──────────────────────────┘            │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼ SQLAlchemy
┌─────────────────────────────────────────────────────────────────────────┐
│                              DATA LAYER                                  │
│  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │
│  │   quote.db     │ │ shipping_      │ │   users.db     │              │
│  │  ───────────   │ │ indices.db     │ │  ───────────   │              │
│  │  • Ports       │ │  ───────────   │ │  • Users       │              │
│  │  • Containers  │ │  • BDI/SCFI    │ │  • AI History  │              │
│  │  • Quotes      │ │  • CCFI        │ └────────────────┘              │
│  │  • Biddings    │ └────────────────┘                                 │
│  │  • Contracts   │ ┌────────────────┐                                 │
│  │  • Shipments   │ │ news_intel.db  │                                 │
│  └────────────────┘ └────────────────┘                                 │
└─────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼ External API
┌─────────────────────────────────────────────────────────────────────────┐
│                          EXTERNAL SERVICES                               │
│  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │
│  │  BOK API       │ │  GDELT API     │ │  Gemini API    │              │
│  │  (한국은행)     │ │  (글로벌 뉴스)  │ │  (AI 대화)     │              │
│  └────────────────┘ └────────────────┘ └────────────────┘              │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.2 디렉토리 구조

```
AAL/
├── frontend/                    # 프론트엔드
│   ├── pages/                   # HTML 페이지
│   │   ├── quotation.html       # 견적 요청
│   │   ├── bidding-list.html    # 비딩 목록 (포워더용)
│   │   ├── shipper-bidding.html # 내 견적 (화주용)
│   │   ├── market-data.html     # 시장 데이터
│   │   ├── news-intelligence.html # 뉴스
│   │   ├── dashboard-shipper.html # 화주 대시보드
│   │   └── ...
│   ├── js/
│   │   ├── features/            # 기능별 JS 모듈
│   │   │   ├── ai-assistant.js  # AI 어시스턴트
│   │   │   ├── biddingList.js   # 비딩 목록
│   │   │   └── ...
│   │   └── core/                # 공통 모듈
│   └── css/                     # 스타일시트
│       ├── variables.css        # CSS 변수
│       ├── components/          # 컴포넌트 스타일
│       └── sections/            # 섹션별 스타일
│
├── server/                      # Flask 백엔드
│   ├── main.py                  # Flask 앱 진입점
│   ├── gemini_backend.py        # AI 백엔드
│   ├── ai_tools.py              # AI Tool 함수
│   ├── prompts/                 # AI 프롬프트
│   ├── auth/                    # 인증 모듈
│   ├── news_intelligence/       # 뉴스 모듈
│   └── shipping_indices/        # 해운 지수 모듈
│
├── quote_backend/               # FastAPI 백엔드
│   ├── main.py                  # FastAPI 앱
│   ├── models.py                # SQLAlchemy 모델
│   ├── schemas.py               # Pydantic 스키마
│   ├── database.py              # DB 연결
│   └── quote.db                 # SQLite DB
│
└── docs/                        # 문서
    ├── AAL_MASTER_SPECIFICATION.md  # 마스터 기획서 (본 문서)
    └── ...
```

### 2.3 서버 구성

| 서버 | 포트 | 역할 | 기술 |
|------|------|------|------|
| **Flask Server** | 5000 | 정적 파일 서빙, AI/Market/News API | Flask + Python |
| **FastAPI Server** | 8001 | Quote/Bidding/Contract API | FastAPI + Python |

---

## 3. 사용자 모델 및 권한 체계

### 3.1 사용자 유형

| 유형 | 코드 | 설명 |
|------|------|------|
| **Guest** | `guest` | 비로그인 사용자 |
| **Shipper (화주)** | `shipper` | 운송 서비스를 의뢰하는 기업 |
| **Forwarder (포워더)** | `forwarder` | 운송 서비스를 제공하는 물류 기업 |

### 3.2 사용자 데이터 모델

```
┌─────────────────────────────────────────┐
│                 User                     │
├─────────────────────────────────────────┤
│ id            : INTEGER (PK)            │
│ user_type     : STRING (shipper/forwarder)│
│ company       : STRING (회사명)          │
│ business_no   : STRING (사업자등록번호)  │
│ name          : STRING (담당자명)        │
│ email         : STRING (이메일, UNIQUE)  │
│ phone         : STRING (연락처)          │
│ password_hash : STRING (bcrypt)         │
│ is_active     : BOOLEAN                 │
│ is_verified   : BOOLEAN                 │
│ created_at    : DATETIME                │
│ last_login_at : DATETIME                │
└─────────────────────────────────────────┘
```

### 3.3 기능별 접근 권한 매트릭스

| 기능 | Guest | Shipper | Forwarder |
|------|:-----:|:-------:|:---------:|
| **견적 조회 (운임 계산)** | ✅ | ✅ | ✅ |
| **시장 데이터 조회** | ✅ | ✅ | ✅ |
| **뉴스 조회** | ✅ | ✅ | ✅ |
| **견적 요청 제출** | ❌ | ✅ | ❌ |
| **비딩 목록 조회** | ❌ | ✅ (본인) | ✅ (전체) |
| **입찰 제출** | ❌ | ❌ | ✅ |
| **낙찰 처리** | ❌ | ✅ | ❌ |
| **계약 관리** | ❌ | ✅ | ✅ |
| **대시보드** | ❌ | ✅ | ✅ |
| **AI 비딩 생성** | ❌ | ✅ | ❌ |

### 3.4 인증 플로우

```
┌──────────────────────────────────────────────────────────────┐
│                      회원가입 플로우                          │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  [회원가입 버튼] → [사용자 유형 선택] → [정보 입력]           │
│                    (화주/포워더)      (회사명, 이메일 등)     │
│                                              │               │
│                                              ▼               │
│                                      [비밀번호 암호화]        │
│                                      (bcrypt hash)          │
│                                              │               │
│                                              ▼               │
│                                      [DB 저장] → [로그인]    │
│                                                              │
└──────────────────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────────────────┐
│                       로그인 플로우                           │
├──────────────────────────────────────────────────────────────┤
│                                                              │
│  [로그인 버튼] → [이메일/비밀번호 입력] → [서버 검증]         │
│                                              │               │
│                                              ▼               │
│                                      [비밀번호 확인]          │
│                                      (bcrypt verify)        │
│                                              │               │
│                    ┌─────────────────────────┴───────┐       │
│                    ▼                                 ▼       │
│              [성공: 세션 생성]               [실패: 오류 반환] │
│              localStorage에 저장                             │
│              {id, user_type, company, email}                │
│                                                              │
└──────────────────────────────────────────────────────────────┘
```

### 3.5 세션 관리

**클라이언트 저장소**:
```javascript
// localStorage 구조
{
  "user": {
    "id": 1,
    "user_type": "shipper",
    "company": "아로와랩스",
    "name": "홍길동",
    "email": "user@example.com"
  }
}
```

**세션 활용**:
- AI Assistant: 사용자 컨텍스트 전달
- API 요청: 사용자별 데이터 필터링
- UI: 사용자 유형별 메뉴/기능 표시

---

## 4. 기능 모듈 개요

### 4.1 핵심 기능 모듈

| 모듈 | 설명 | 상세 문서 |
|------|------|-----------|
| **견적 요청 (Quotation)** | 화주가 운송 요청서 작성, Quick Quote 제공 | [QUOTATION_SPEC.md](QUOTATION_SPEC.md) |
| **비딩 (Bidding)** | 포워더 입찰, 화주 낙찰 처리 | [BIDDING_SPEC.md](BIDDING_SPEC.md) |
| **Market Intelligence** | 시장 지수, 환율, 뉴스 제공 | [INTELLIGENCE_SPEC.md](INTELLIGENCE_SPEC.md) |
| **AI Assistant** | 대화형 AI 어시스턴트 | [AI_ASSISTANT_SPEC.md](AI_ASSISTANT_SPEC.md) |

### 4.2 지원 기능 모듈

| 모듈 | 설명 | 상태 |
|------|------|------|
| **계약 관리 (Contract)** | 낙찰 후 계약 확정/관리 | 준비중 |
| **배송 추적 (Shipment)** | 운송 상태 추적 | 준비중 |
| **정산 (Settlement)** | 비용 정산 관리 | 준비중 |
| **대시보드 (Dashboard)** | 통계/분석 대시보드 | 준비중 |

### 4.3 기능 흐름도

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          화주 (Shipper) 플로우                           │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   [견적 요청]      [입찰 대기]      [입찰 비교]      [낙찰 선정]           │
│       │               │               │               │                  │
│       ▼               ▼               ▼               ▼                  │
│   ┌───────┐       ┌───────┐       ┌───────┐       ┌───────┐             │
│   │ Quote │  →    │Bidding│  →    │Compare│  →    │ Award │             │
│   │Request│       │ Open  │       │ Bids  │       │  Bid  │             │
│   └───────┘       └───────┘       └───────┘       └───────┘             │
│       │                                               │                  │
│       └───────────── Quick Quote (즉시 운임 조회) ─────┘                  │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                         포워더 (Forwarder) 플로우                        │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   [비딩 검색]      [상세 확인]      [입찰 제출]      [낙찰 대기]           │
│       │               │               │               │                  │
│       ▼               ▼               ▼               ▼                  │
│   ┌───────┐       ┌───────┐       ┌───────┐       ┌───────┐             │
│   │Bidding│  →    │ View  │  →    │Submit │  →    │ Wait  │             │
│   │ List  │       │Detail │       │  Bid  │       │ Award │             │
│   └───────┘       └───────┘       └───────┘       └───────┘             │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 기술 스택

### 5.1 Frontend

| 항목 | 기술 |
|------|------|
| **마크업** | HTML5 |
| **스타일** | CSS3, CSS Variables |
| **스크립트** | Vanilla JavaScript (ES6+) |
| **폰트** | Inter, Pretendard |
| **아이콘** | Font Awesome 6 |
| **차트** | Chart.js |
| **지도** | Leaflet.js |
| **워드클라우드** | wordcloud2.js |

### 5.2 Backend

| 항목 | 기술 |
|------|------|
| **웹 서버 (Main)** | Flask 2.x (Python) |
| **API 서버 (Quote)** | FastAPI (Python) |
| **ORM** | SQLAlchemy |
| **데이터 검증** | Pydantic |
| **비밀번호 암호화** | bcrypt |
| **AI** | Google Gemini API |

### 5.3 Database

| DB | 용도 | 위치 |
|-----|------|------|
| **quote.db** | 견적, 비딩, 계약, 마스터 데이터 | `quote_backend/quote.db` |
| **users.db** | 사용자, AI 대화 이력 | `server/auth/users.db` |
| **shipping_indices.db** | 해운 지수 | `server/shipping_indices.db` |
| **news_intelligence.db** | 뉴스 데이터 | `server/news_intelligence.db` |

### 5.4 외부 API

| API | 용도 | 제공처 |
|-----|------|--------|
| **BOK API** | 환율, 금리, 경제지표 | 한국은행 |
| **GDELT API** | 글로벌 뉴스, 이벤트 | GDELT Project |
| **Gemini API** | AI 대화, Tool Calling | Google |

---

## 6. 관련 문서

### 6.1 상세 기획서

| 문서 | 설명 |
|------|------|
| [QUOTATION_SPEC.md](QUOTATION_SPEC.md) | 견적 요청 시스템 상세 기획서 |
| [BIDDING_SPEC.md](BIDDING_SPEC.md) | 비딩 시스템 상세 기획서 |
| [INTELLIGENCE_SPEC.md](INTELLIGENCE_SPEC.md) | Market Intelligence 기획서 |
| [AI_ASSISTANT_SPEC.md](AI_ASSISTANT_SPEC.md) | AI Assistant 기획서 |

### 6.2 기술 문서

| 문서 | 설명 |
|------|------|
| [SCREEN_DEFINITION.md](SCREEN_DEFINITION.md) | 화면 정의서 |
| [API_SPECIFICATION.md](API_SPECIFICATION.md) | API 명세서 |
| [DATA_MODEL.md](DATA_MODEL.md) | 데이터 모델 정의서 |

---

## 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 1.0.0 | 2026-01-19 | - | 초기 작성 |
