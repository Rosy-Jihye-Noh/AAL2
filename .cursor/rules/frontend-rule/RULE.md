---
description: "프론트엔드 개발 작업 규칙 및 가이드라인"
globs: ["frontend/**/*"]
alwaysApply: false
---

# 프론트엔드 개발 규칙

## 기본 원칙

1. **백엔드 코드 절대 수정 금지**
   - 프론트엔드 작업 시 `server/` 디렉토리 내 파일은 절대 수정하지 않는다.
   - API 호출은 기존 엔드포인트를 사용하며, 새로운 엔드포인트가 필요한 경우 백엔드 팀과 협의한다.

2. **메인 파일 구조**
   - 메인 프론트엔드 파일: `frontend/ai_studio_code_F2.html` (단일 파일 구조)

## 작업 전 사전 검증

새로운 기능을 개발하기 전에 다음을 확인:

1. **통합 검증 스크립트 실행**
   ```bash
   python scripts/validate_integration.py
   ```
   - 에러가 있으면 먼저 수정
   - 경고 메시지 확인 및 필요 시 수정

2. **파일 참조 확인**
   - RULE.md에서 언급한 파일들이 실제로 존재하는지 확인
   - 참조된 함수/변수가 실제 코드에 존재하는지 확인

3. **의존성 확인**
   - 다른 Agent의 작업이 필요한지 확인
   - API 엔드포인트가 이미 존재하는지 확인
   - 백엔드 Agent와 협의가 필요한지 확인

4. **일관성 확인**
   - 기존 코드 스타일과 일치하는지 확인
   - 네이밍 컨벤션이 일치하는지 확인
   - CSS 변수 네이밍이 일관된지 확인

## 코딩 스타일

1. **JavaScript**
   - ES6+ 문법 사용 (const, let, arrow functions, template literals 등)
   - 함수명은 `camelCase`를 사용한다.
   - 전역 변수 사용을 최소화한다.

2. **CSS**
   - CSS 변수(`:root`)를 활용한 테마 관리
   - 반응형 디자인을 고려한다.
   - 클래스명은 `kebab-case`를 사용한다.

3. **HTML**
   - 시맨틱 HTML 태그 사용
   - 접근성을 고려한 마크업

## 차트 개발 규칙

**중요**: 모든 차트는 `.cursor/rules/uiux-rule/CHART_STANDARD.md`의 표준을 따라야 합니다.

### 차트 표준 문서
자세한 차트 개발 표준은 다음 파일을 참조하세요:
- `.cursor/rules/uiux-rule/CHART_STANDARD.md` - 차트 컴포넌트 UI/UX 표준

### 주요 차트 개발 규칙 요약

1. **함수 네이밍 컨벤션**
   - 초기화: `init[ChartName]()`
   - 데이터 가져오기: `fetch[ChartName]Data()`
   - 차트 업데이트: `update[ChartName]Chart()`
   - X축 라벨: `render[ChartName]XAxisLabels()`
   - Y축 라벨: `render[ChartName]YAxisLabels()`
   - SVG 경로: `generate[ChartName]SVGPath()`

2. **SVG 차트**
   - SVG 요소를 직접 조작하여 차트를 그린다.
   - viewBox: `0 0 1200 400` (통일)
   - padding: `{ top: 20, bottom: 30, left: 40, right: 20 }`
   - `update[ChartName]Chart()` 함수에서 차트를 업데이트한다.
   - 성능을 위해 `requestAnimationFrame`을 활용한다.

3. **차트 타입 결정**
   - Line Chart: 데이터 포인트 2개 이상
   - Bar Chart: 데이터 포인트 1개 또는 2개 미만

4. **인터랙티브 기능**
   - 툴팁은 `position: fixed`를 사용하여 viewport 기준으로 위치를 계산한다.
   - `show[ChartName]Tooltip()` 함수에서 동적 위치 조정 (좌/우/상/하 경계 체크)
   - `mousemove` 이벤트는 `requestAnimationFrame`으로 스로틀링한다.

5. **X축 레이블**
   - `render[ChartName]XAxisLabels()` 함수에서 주기에 따라 레이블 형식 변경
   - 연도별(A): 매년 1월, 4월, 7월, 10월만 표시
   - 월별(M): 매 2개월마다 표시
   - 분기별(Q): 모든 분기 표시

## API 호출 규칙

1. **Fetch API 사용**
   - `fetch()`를 사용하여 API를 호출한다.
   - 에러 처리는 try-catch 블록으로 감싼다.

2. **데이터 처리**
   - API 응답 데이터는 `processExchangeRateData()` 함수에서 처리한다.
   - 날짜 형식 변환: `YYYYMMDD` → `YYYY-MM-DD` (표시용)

3. **캐싱**
   - 툴팁 데이터는 `rebuildTooltipCache()`로 캐싱하여 성능 최적화

## UI/UX 규칙

1. **반응형 디자인**
   - 모바일, 태블릿, 데스크톱 모두 지원
   - `clamp()` 함수를 활용한 유연한 폰트 크기

2. **애니메이션**
   - CSS transition을 활용한 부드러운 전환
   - `reveal` 클래스를 사용한 스크롤 애니메이션

3. **색상 시스템**
   - CSS 변수로 통화별 색상 정의
   - 상승: 빨간색 (#ef4444), 하락: 초록색 (#22c55e)

## 성능 최적화

1. **이벤트 리스너**
   - `mousemove` 이벤트는 스로틀링 적용
   - 불필요한 이벤트 리스너는 제거

2. **DOM 조작**
   - DOM 조작을 최소화한다.
   - `innerHTML` 대신 `textContent` 또는 `createElement` 사용

3. **렌더링**
   - `transform: translate3d`를 사용하여 GPU 가속 활용

## 개발 후 검증 프로세스

### 1. 기능 동작 검증

#### API 호출 검증
- [ ] 브라우저 개발자 도구 → Network 탭에서 API 호출 확인
  - 요청 URL이 올바른지 확인 (`/api/market/indices?type=...`)
  - HTTP 상태 코드 확인 (200 OK)
  - 응답 데이터 구조 확인 (JSON 형식)
- [ ] 에러 케이스 테스트
  - 잘못된 날짜 형식 입력 시 에러 처리 확인
  - API 실패 시 사용자에게 명확한 메시지 표시 확인
  - 네트워크 오류 시 적절한 처리 확인

#### 데이터 처리 검증
- [ ] API 응답 데이터가 올바르게 파싱되는지 확인
  - `console.log()`로 데이터 구조 확인
  - 날짜 형식 변환이 올바른지 확인 (YYYYMMDD → YYYY-MM-DD)
  - 숫자 값이 올바르게 파싱되는지 확인
- [ ] 빈 데이터 처리 확인
  - 데이터가 없을 때 "-" 또는 적절한 메시지 표시
  - 차트가 빈 상태로 렌더링되는지 확인

#### 차트 렌더링 검증
- [ ] 차트가 올바르게 그려지는지 확인
  - SVG 경로가 생성되는지 확인
  - Y축 레이블이 올바른 범위로 표시되는지 확인
  - X축 레이블이 올바른 날짜 형식으로 표시되는지 확인
  - 데이터 포인트(마커)가 올바른 위치에 표시되는지 확인
- [ ] 다중 시리즈 차트 검증
  - 여러 항목 선택 시 모든 라인이 표시되는지 확인
  - 각 라인의 색상이 올바른지 확인
  - 범례 클릭으로 시리즈 표시/숨김이 동작하는지 확인

#### 인터랙티브 기능 검증
- [ ] 툴팁 동작 확인
  - 마우스 호버 시 툴팁 표시
  - 툴팁 위치가 화면 경계를 벗어나지 않는지 확인
  - 툴팁 내용이 올바른 데이터를 표시하는지 확인
- [ ] 필터 및 컨트롤 동작 확인
  - 날짜 범위 변경 시 차트 업데이트 확인
  - 빠른 기간 버튼 클릭 시 날짜 및 차트 업데이트 확인
  - 항목 선택/해제 시 차트 업데이트 확인

### 2. 성능 검증

- [ ] 브라우저 개발자 도구 → Performance 탭
  - 페이지 로드 시간 확인
  - 차트 렌더링 시간 확인 (60fps 유지)
  - 메모리 누수 확인 (메모리 프로파일링)
- [ ] 이벤트 리스너 최적화 확인
  - `mousemove` 이벤트가 스로틀링되는지 확인
  - 불필요한 이벤트 리스너가 제거되었는지 확인

### 3. 브라우저 호환성 검증

- [ ] 주요 브라우저에서 테스트
  - Chrome/Edge (최신 버전)
  - Firefox (최신 버전)
  - Safari (최신 버전)
- [ ] 모바일 브라우저 테스트
  - iOS Safari
  - Android Chrome

### 4. 콘솔 에러 확인

- [ ] 브라우저 개발자 도구 → Console 탭
  - JavaScript 에러가 없는지 확인
  - 경고 메시지 확인 및 필요 시 수정
  - `console.log()` 디버깅 코드 제거 (선택적)

### 5. 코드 품질 검증

- [ ] 코딩 스타일 준수
  - 함수명이 `camelCase`인지 확인
  - 전역 변수 사용 최소화 확인
  - ES6+ 문법 사용 확인
- [ ] 주석 및 문서화
  - 복잡한 로직에 주석 추가 확인
  - 함수 목적이 명확한지 확인

### 검증 체크리스트 요약

작업 완료 후 다음 항목을 모두 확인:

```
□ API 호출이 정상적으로 이루어지는가?
□ 데이터가 올바르게 파싱되고 표시되는가?
□ 차트가 올바르게 렌더링되는가?
□ 에러 처리가 적절한가?
□ 성능 문제가 없는가?
□ 브라우저 호환성 문제가 없는가?
□ 콘솔 에러가 없는가?
□ 코드 품질이 기준을 만족하는가?
```

### 문제 발견 시 조치

1. **API 호출 실패**: 백엔드 Agent와 협의하여 API 엔드포인트 확인
2. **데이터 파싱 오류**: API 응답 구조 확인 및 파싱 로직 수정
3. **차트 렌더링 오류**: SVG 경로 생성 로직 및 좌표 계산 확인
4. **성능 문제**: 이벤트 리스너 최적화, DOM 조작 최소화
5. **브라우저 호환성**: 폴리필 추가 또는 대체 구현

## 참고 파일

- `@frontend/ai_studio_code_F2.html` - 메인 프론트엔드 파일
- `@docs/CURRENCY_MAPPING_TABLE.md` - 통화 매핑 정보

